; ============================
; Asterisk Dialplan
; ============================

[default]
include => local-users

[local-users]
; Local call
exten => 1001,1,NoOp(Local call to 1001)
 same => n,Dial(PJSIP/1001,20)

; Echo test
exten => 600,1,Answer()
 same => n,Playback(demo-echotest)
 same => n,Hangup()

; --- Outbound calls ---
; Handle +E.164 numbers (international format, e.g. +14155551234)
exten => _+X.,1,NoOp(Normalizing outbound E.164 ${EXTEN})
 same => n,Dial(PJSIP/${EXTEN}@twilio)

; Handle plain numbers (no + sign)
exten => _X.,1,NoOp(Outbound call to ${EXTEN} via Twilio)
 same => n,Dial(PJSIP/${EXTEN}@twilio)

[from-twilio]
; Route inbound Twilio calls to local user
exten => _X.,1,NoOp(Incoming call from Twilio to ${EXTEN})
 same => n,Dial(PJSIP/1001)
